// ========= ENUMS =========

enum OtpType {
  SIGN_UP
  LOGIN
  FORGET_PASSWORD
}

enum OauthProvider {
  NONE
  FACEBOOK
  GOOGLE
}

// ========= MODELS =========

model Otp {
  id         String   @id @default(uuid())
  type       OtpType
  hashedOtp  String
  identifier String
  expiresAt  DateTime
  isActive   Boolean  @default(true)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt()
}

model User {
  id       String  @id @default(uuid())
  hashedPassword String?

  // Relations
  email       String @unique
  name         String
  avatarUrl    String?
  contactEmail String? // for notifications, can differ from login email
  refreshTokens RefreshToken[]
 
  // Audit & Timestamps
  lastLoginAt DateTime?
  isVerified Boolean        @default(false)

  oauthProvider                OauthProvider?         @default(NONE)
  oauthId                      String?

  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
}



model RefreshToken {
  id        String    @id @default(uuid())
  token     String    @unique
  userId    String
  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  userAgent String?
  ipAddress String?
  expiresAt DateTime
  revokedAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt()
}
